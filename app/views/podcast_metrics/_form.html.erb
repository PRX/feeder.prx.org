<% data = {controller: "apex-nav click", apex_nav_main_card_value: main_card, click_debounce_value: 200} %>

<%= form_with(url: podcast_metrics_path(podcast), method: :get, id: "podcast_metrics_tab", data: data) do |form| %>
  <div class="container col-12 align-items-center my-4">
    <div class="row justify-content-between">
      <div class="col-4">
        <h1 class="fw-bold my-0 mb-0 me-4"><%= t(".header") %></h1>
      </div>
      <div class="col-5">
        <%= render "metrics/filter_dates", form: form, date_preset: date_preset, date_start: date_start, date_end: date_end, interval: interval, episode: nil %>
      </div>
    </div>
  </div>
  <div class="container col-12 my-4">
    <%= render "main_card", form: form, podcast: podcast, date_preset: date_preset, date_start: date_start, date_end: date_end, interval: interval, uniques_selection: uniques_selection, dropday_range: dropday_range %>
  </div>

  <div class="container col-12 mb-2">
    <div class="col mb-4">
      <div class="row gx-2">
        <div class="col-6 mb-2">
          <%= render "geo_card", geo_type: "Countries" %>
        </div>
        <div class="col-6 mb-2">
          <%= render "geo_card", geo_type: "Metros" %>
        </div>
      </div>
    </div>
    <div class="col mb-4">
      <%# turbo_frame_tag "agents", src: agents_podcast_metrics_path(podcast: @podcast), loading: "lazy" %>
    </div>
  </div>

  <%= form.text_field :main_card, value: main_card, class: "d-none", data: {apex_nav_target: "mainCard", action: "change->click#submit"} %>
  <%= form.submit class: "d-none", data: {click_target: "submit"} %>
<% end %>
